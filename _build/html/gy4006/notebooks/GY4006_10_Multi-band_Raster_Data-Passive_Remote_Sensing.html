
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Multi-band Raster Data: Passive Remote Sensing &#8212; GY4006 GIS and Geospatial Data Analysis</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'gy4006/notebooks/GY4006_10_Multi-band_Raster_Data-Passive_Remote_Sensing';</script>
    <link rel="canonical" href="https://bamacgabhann.github.io/GY4006/gy4006/notebooks/GY4006_10_Multi-band_Raster_Data-Passive_Remote_Sensing.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Before you start" href="../exercises/start.html" />
    <link rel="prev" title="Single-band Raster Data" href="GY4006_9_Single-band_Raster_Data.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/GY4006_logo-02.png" class="logo__image only-light" alt="GY4006 GIS and Geospatial Data Analysis - Home"/>
    <script>document.write(`<img src="../../_static/GY4006_logo-02.png" class="logo__image only-dark" alt="GY4006 GIS and Geospatial Data Analysis - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../README.html">
                    GY4006: GIS and Geospatial Data Analysis
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Geospatial Data Analysis - Notebooks</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="GY4006_1_Geospatial_Software_and_Programming_Languages.html">Geospatial Software and Programming Languages</a></li>
<li class="toctree-l1"><a class="reference internal" href="GY4006_2_Data_Types.html">Data, and Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="GY4006_3_Vector_Data.html">Vector Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="GY4006_4_Attribute_Data.html">Attribute Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="GY4006_5_Coordinate_Reference_Systems.html">Coordinate Reference Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="GY4006_6_Geospatial_Data_Files.html">Creating and Using Geospatial Data Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="GY4006_7_Vector_Geoprocessing.html">Vector Geoprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="GY4006_8_Introduction_To_Raster_Data.html">Raster Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="GY4006_9_Single-band_Raster_Data.html">Single-band Raster Data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Multi-band Raster Data: Passive Remote Sensing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">GIS Exercise</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../exercises/start.html">Before you start</a></li>




<li class="toctree-l1"><a class="reference internal" href="../exercises/01_Adding_Rivers_Lakes.html">01: Rivers and Lakes <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/02_Adding_water_level_monitors.html">02: Water Level Monitors <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/03_Adding_The_AOIs.html">03: Areas of Interest (AOIs) <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/04_Adding_basemap.html">04: Adding A Tile Basemap <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/05_CRS.html">05: Coordinate Reference Systems in QGIS <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/06_lake_symbology.html">06: Lakes Symbology <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/07_river_symbology.html">07: Rivers Symbology <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/08_your_AOI.html">08: Your Area of Interest (AOI) <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/09_AOI_symbology.html">09: Your AOI <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/10_AOI_buffer.html">10: AOI Buffer <code class="docutils literal notranslate"><span class="pre">[B-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/11_clipping_rivers_lakes.html">11: Clipping Rivers and Lakes <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/12_clip_water_level_monitors.html">12: Clipping Water Level Monitors <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/13_monitors_symbology.html">13: Water Level Monitors symbology <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/14_Adding_DEM.html">The Digital Elevation Model <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/15_clip_DEM.html">15: Clipping the DEM <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/16_DEM_hillshade.html">16: Hillshading the DEM <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/17_water_levels.html">17: Flood water levels <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/18_flood_risk_map.html">18: Creating a Flood Risk Map <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/19_vectorise_flood_map.html">19: Vectorise the flood risk map(s) <code class="docutils literal notranslate"><span class="pre">[B-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/20_aoi_geojson.html">20: Saving your AOI buffer as a GeoJSON for export <code class="docutils literal notranslate"><span class="pre">[B-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/21_sentinel_2.html">21: Multispectral Satellite Imagery <code class="docutils literal notranslate"><span class="pre">[B-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/22_bands_in_qgis.html">22: Visualising Sentinel-2 Imagery in QGIS <code class="docutils literal notranslate"><span class="pre">[A-grades]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/23_census_small_areas.html">23: Census Small Areas <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/24_clip_census.html">24: Clipping the Census Small Area vector polygons <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/25_census_data.html">25: Census Small Areas Data <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/26_join_census.html">26: Join the census polygons to the census data tables <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/27_field_calculator.html">27: Calculating a new social class attribute <code class="docutils literal notranslate"><span class="pre">[B-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/28_thematic_map.html">28: Thematic maps of census data <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/29_georeferencing.html">29: Georeferencing <code class="docutils literal notranslate"><span class="pre">[A-grades]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/30_digitising.html">30: Digitising Features <code class="docutils literal notranslate"><span class="pre">[A-grades]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/31_self_directed.html">31: Self-directed tasks <code class="docutils literal notranslate"><span class="pre">[A1-grades]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/32_print_layouts.html">32: Print Layouts <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/33_second_print_layout.html">33: A second print layout <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/34_multi-map_layouts.html">34: Multi-map Print Layouts <code class="docutils literal notranslate"><span class="pre">[A-grades]</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/35_report.html">35: Report <code class="docutils literal notranslate"><span class="pre">[C-grades</span> <span class="pre">and</span> <span class="pre">above]</span></code></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/bamacgabhann/GY4006/blob/main/gy4006/gy4006/notebooks/GY4006_10_Multi-band_Raster_Data-Passive_Remote_Sensing.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/gy4006/notebooks/GY4006_10_Multi-band_Raster_Data-Passive_Remote_Sensing.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Multi-band Raster Data: Passive Remote Sensing</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multispectral-imaging-msi">1. Multispectral Imaging (MSI)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning">2. Data Cleaning</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#false-colour-visualisations">3. False Colour Visualisations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#indices">4. Indices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#segmentation">5. Segmentation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a href="https://colab.research.google.com/github/bamacgabhann/GY4006/blob/main/gy4006/notebooks/GY4006_10_Multi-band_Raster_Data-Passive_Remote_Sensing.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<img src="https://raw.githubusercontent.com/bamacgabhann/GY4006/main/gy4006/assets/images/GY4006_logo-01.png" align=center alt="UL Geography logo"/><section class="tex2jax_ignore mathjax_ignore" id="multi-band-raster-data-passive-remote-sensing">
<h1>Multi-band Raster Data: Passive Remote Sensing<a class="headerlink" href="#multi-band-raster-data-passive-remote-sensing" title="Link to this heading">#</a></h1>
<p>In the <em>Introduction to Raster Data</em> Notebook, we used a satellite photograph as our first step in working with raster data. In the <em>Single-band Raster Data</em> Notebook, we then looked at rasters with a single band or dataset - elevation data first, and then temperature data.</p>
<p>However, the photographs we used in the <em>Introduction to Raster Data</em> Notebook actually had three bands, not just a single band - one band each for red, green, and blue colour.</p>
<p>This is actually multi-band passive remote sensing data, the subject of this Notebook.</p>
<p>We saw in the photographs how each raster had separate arrays for red, green and blue - that’s our three bands, hence multi-band. But what do I mean by <em>passive remote sensing?</em></p>
<p>The <em>sensing</em> part is using an instrument to collect data. A camera counts: it has a sensor which records values for the intensity of red, green, and blue light collected.</p>
<p>The <em>remote</em> part simply means “at a distance”. We’re not taking a reading in contact with the object we’re measuring, like when we put a ruler across something to measure it’s size. We’re doing it from far away. A satellite is pretty far above the Earth when it takes a photo: that definitely counts as remote.</p>
<p>The <em>passive</em> part means that the instrument is not transmitting a signal - just receiving. The satellite taking the photograph isn’t shining a light onto the Earth - it’s taking advantage of another source of light. The sun illuminates the Earth, and some of the sunlight is reflected from the ground back into space, where it can be collected by cameras on satellites.</p>
<p>We can take a step back here, and think about everything which has to happen in order for a remote sensing instrument to receive data.</p>
<ol class="arabic simple">
<li><p>A source of energy emits that energy</p></li>
<li><p>That energy travels from the source to the target</p></li>
<li><p>The energy interacts in some way with the target</p></li>
<li><p>The energy travels from the target to the sensor</p></li>
<li><p>The sensor records the energy as data</p></li>
<li><p>The data is processed</p></li>
<li><p>The processed data is analysed</p></li>
</ol>
<p>For most remote sensing, the energy is part of the electromagnetic spectrum. That’s absolutely not always the case - seismographs measure vibrations (basically sound energy) to monitor earthquakes, and seismic surveys by oil and gas companies do the same. Some satellites measure gravity. We won’t be looking at any of that data, though.</p>
<p>The electromagnetic spectrum includes the visible light we can see; plus higher-energy ultraviolet, X-rays, and gamma rays; and lower energy infrared and radio waves. There are passive remote sensing instruments across this entire range: however, some of these like X-rays and gamma rays are mostly used in astronomy.</p>
<p>In this Notebook, we will focus on visible and infrared light.</p>
<p>The source of energy in passive remote sensing of visible and infrared light is, as we said, the Sun. So, breaking down into our list again:</p>
<ol class="arabic simple">
<li><p>The sun emits energy.
The Sun emits energy across most of the electromagnetic spectrum. There’s some minor details if you’re interested in solar astronomy, but for our purposes, we don’t have to worry about this. It’s not a case that the Sun emits more green light than red light: for our purposes, we can consider it essentially even, as white light.</p></li>
<li><p>Some of that energy travels to Earth.</p></li>
</ol>
<p>Travel from the Sun to Earth is mostly insignificant; however, once the signal reaches Earth, it has to travel through the atmosphere before reaching the ground. This does have some effects; some light bounces off air molecules in the atmosphere, mostly blue light - which is why the sky is blue when you look up - well, unless it’s cloudy, I suppose. Which is really the major issue - clouds block the light, and satellite photographs of a cloudy area will just show…clouds. Not the ground surface.</p>
<p>I’ll skip a step here to note that the same thing will happen at:</p>
<ol class="arabic simple" start="4">
<li><p>Energy travels from the target to the sensor.
For satellite sensors, the energy must travel all the way back through the atmosphere. There are other remote sensing platforms - aircraft and UAVs can take photographs using the light that manages to get through the clouds, and can sit below clouds so they don’t need to worry about them. There’s also instruments like cameras which can be used on the ground.</p></li>
<li><p>When the data is received by the sensor, of course the sensitivity and resolution of the sensor control what can be recorded. Again, we can use the example of a camera, and remember how good cameras on phones are now compared to over a decade ago - more megapixels means better data, and similar.</p></li>
<li><p>The processing is not something most people working with data really need to get into - but the first stage would be things like adding geographic information. There can also be correction to account for the effects of passing through the atmosphere.</p></li>
<li><p>The analysis is the bit that we do.</p></li>
</ol>
<p>The skipped step is crucial, though:</p>
<ol class="arabic simple" start="3">
<li><p>The energy interacts with the target.
This is the key step. There’s essentially three things which can happen here.</p>
<ol class="arabic simple">
<li><p>The energy can be <em>transmitted</em>, passing through the target completely.</p></li>
<li><p>The energy can be <em>absorbed</em> by the target.</p></li>
<li><p>The energy can be <em>reflected</em> by the target.</p></li>
</ol>
</li>
</ol>
<p>We discussed an example of transmitted energy in the Single-Band Raster Data Notebook - how some RADAR signals can pass through tree canopies. This will then reach another target - in that case, the ground.</p>
<p>Whether the signal is ultimately absorbed or reflected is something we have a word for, when it comes to visible light: colour.</p>
<p>Plants are green because they <em>reflect</em> green light, but <em>absorb</em> blue and red light. So when white light from the sun hits a plant, we see only the reflected green light. Similarly, tomatoes are red because they absorb the green and blue but reflect the red light. Objects which are other colours reflect some combinations, for example purple objects reflect both red and blue. White objects reflect all light, and black objects absorb it all.</p>
<p>But - this only refers to the visible colours we can see. What about the infrared?</p>
<p>Exactly the same thing happens - we just can’t see it. But we have sensors which can.</p>
<section id="multispectral-imaging-msi">
<h2>1. Multispectral Imaging (MSI)<a class="headerlink" href="#multispectral-imaging-msi" title="Link to this heading">#</a></h2>
<p>The satellite image we used for Killarney in the <em>Introduction to Raster Data</em> Notebook wasn’t actually a true photograph. It was a combination of red, green, and blue bands collected by one of the Sentinel-2 satellites, part of the EU’s Copernicus Earth Observation programme. The Sentinel-2 satellites don’t just collect visible light - they are <em>Multispectral Imaging</em> satellites, which actually collect data in 13 different bands. As well as red, green, and blue visible light, there’s one band at the ultraviolet edge of blue light, and nine different bands of infrared light. You can think of this as nine different infrared colours.</p>
<p>Let’s look at the full dataset for Killarney.</p>
<p><strong>Note</strong>
Again, I just want to reinforce that you don’t have to understand the code here - and honestly, <code class="docutils literal notranslate"><span class="pre">rasterio</span></code> is very, <em>very</em> user unfriendly, so I really don’t want you to get discouraged by this.</p>
<p>Instead, it’s the <em>concepts</em> which are important here - and those will be shared across essentially all GIS platforms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s1">&#39;google.colab&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_ipython</span><span class="p">()):</span>
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>osmnx<span class="w"> </span>earthpy<span class="w"> </span>rasterio

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">box</span>
<span class="kn">import</span> <span class="nn">osmnx</span> <span class="k">as</span> <span class="nn">ox</span>
<span class="kn">import</span> <span class="nn">earthpy.spatial</span> <span class="k">as</span> <span class="nn">es</span>
<span class="kn">import</span> <span class="nn">rasterio</span> <span class="k">as</span> <span class="nn">rio</span>
<span class="kn">from</span> <span class="nn">rasterio.plot</span> <span class="kn">import</span> <span class="n">show</span>
<span class="kn">from</span> <span class="nn">rasterio.features</span> <span class="kn">import</span> <span class="n">dataset_features</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">band01</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B01.tiff&#39;</span><span class="p">)</span>
<span class="n">band02</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B02.tiff&#39;</span><span class="p">)</span>
<span class="n">band03</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B03.tiff&#39;</span><span class="p">)</span>
<span class="n">band04</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B04.tiff&#39;</span><span class="p">)</span>
<span class="n">band05</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B05.tiff&#39;</span><span class="p">)</span>
<span class="n">band06</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B06.tiff&#39;</span><span class="p">)</span>
<span class="n">band07</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B07.tiff&#39;</span><span class="p">)</span>
<span class="n">band08</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B08.tiff&#39;</span><span class="p">)</span>
<span class="n">band09</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B09.tiff&#39;</span><span class="p">)</span>
<span class="n">band11</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B11.tiff&#39;</span><span class="p">)</span>
<span class="n">band12</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B12.tiff&#39;</span><span class="p">)</span>
<span class="n">band8A</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B8A.tiff&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax01</span><span class="p">,</span> <span class="n">ax02</span><span class="p">,</span> <span class="n">ax03</span><span class="p">,</span> <span class="n">ax04</span><span class="p">),</span> <span class="p">(</span><span class="n">ax05</span><span class="p">,</span> <span class="n">ax06</span><span class="p">,</span> <span class="n">ax07</span><span class="p">,</span> <span class="n">ax08</span><span class="p">),</span> <span class="p">(</span><span class="n">ax09</span><span class="p">,</span> <span class="n">ax11</span><span class="p">,</span> <span class="n">ax12</span><span class="p">,</span> <span class="n">ax8A</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="mi">14</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">show</span><span class="p">((</span><span class="n">band01</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax01</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Purples&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B01 (Blue/UV edge, 60m)&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">((</span><span class="n">band02</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax02</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B02 (Blue visible light, 10m)&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">((</span><span class="n">band03</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax03</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greens&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B03 (Green visible light, 10m)&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">((</span><span class="n">band04</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax04</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B04 (Red visible light, 10m)&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">((</span><span class="n">band05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax05</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B05 (Red edge, 20m)&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">((</span><span class="n">band06</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax06</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B06 (Red edge, 20m)&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">((</span><span class="n">band07</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax07</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B07 (Red edge, 20m)&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">((</span><span class="n">band08</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax08</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B08 (Near Infrared (NIR), 10m)&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">((</span><span class="n">band09</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax09</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B09 (Near Infrared (NIR), 60m)&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">((</span><span class="n">band11</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax11</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B11 (Short Wave Infrared (SWIR), 20m)&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">((</span><span class="n">band12</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax12</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B12 (Short Wave Infrared (SWIR), 20m)&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">((</span><span class="n">band8A</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax8A</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B8A (Narrow Near Infrared (NIR), 20m)&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">452100</span><span class="p">,</span> <span class="mi">467700</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">5758000</span><span class="p">,</span> <span class="mi">5769500</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="s1">&#39;medium&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/55ee8829e465d8710cd4cc8e298e998147b3c541ac866e2a94935948cc5f0352.png" src="../../_images/55ee8829e465d8710cd4cc8e298e998147b3c541ac866e2a94935948cc5f0352.png" />
</div>
</div>
<p>Three things to say here.</p>
<p>First, only bands 01-04 are visible light. B01 captures a narrow region at the UV edge of blue light; and B02, B03, and B04 are our blue, green, and red light.  I’ve shown these in appropriate colours. B05 and B06 are on the edge between red and infrared, and the other bands are fully infrared ‘colours’: and I’ve shown those in grey above because we don’t have a colour language for them.</p>
<p>The image below shows the visible light spectrum and the near and shortwave infrared, with the ranges of the Sentinel 2 bands:</p>
<img src="https://raw.githubusercontent.com/bamacgabhann/GY5021/2024/GY5021/2_Raster_Geospatial_Data/sample_data/S2_bands.png" align=center alt="Sentinel 2 band ranges"/>
<p>In each of the images above, you should be able to see that different parts of the area are lighter or darker in that particular colour - and the patterns are not identical across all of the images. What’s lighter in some is darker than others; some features are visible on one image, but not another. This is because different objects have different colours, whether in visible or infrared light.</p>
<p>Second, you might notice that there is no Band 10 image in the maps above. This is because the data I’ve given here as the sample has been processed to what’s referred to as <em>L2A</em> (Level 2 A). It’s not crucial to understand all the data processing steps, but <em>L1C</em> (Level 1 C) data is essentially the data processed to the correct geographic area, with no further corrections; <em>L2A</em> data has been further processed to remove the effects of the signal travelling through the atmosphere. Band 10 is used for looking <em>at</em> the atmosphere - so the <em>L2A</em> correction essentially removes all data from Band 10, hence why it isn’t shown above.</p>
<p>Third, this is a rather awkward way of showing everything - I have to specify each image individually. That’s fine for a one off, but if I want to do more with it, it’s going to get awkward.</p>
<p>Each of the images is a raster which stores only a single band. But it’s all showing the same area - so why not make it a single multiband raster? That’s really what it is.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meta</span> <span class="o">=</span> <span class="n">band01</span><span class="o">.</span><span class="n">meta</span>
<span class="n">meta</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>

<span class="n">B01</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;band&#39;</span><span class="p">:</span> <span class="s1">&#39;B01&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B01.tiff&#39;</span><span class="p">}</span>
<span class="n">B02</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;band&#39;</span><span class="p">:</span> <span class="s1">&#39;B02&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B02.tiff&#39;</span><span class="p">}</span>
<span class="n">B03</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;band&#39;</span><span class="p">:</span> <span class="s1">&#39;B03&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B03.tiff&#39;</span><span class="p">}</span>
<span class="n">B04</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;band&#39;</span><span class="p">:</span> <span class="s1">&#39;B04&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B04.tiff&#39;</span><span class="p">}</span>
<span class="n">B05</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;band&#39;</span><span class="p">:</span> <span class="s1">&#39;B05&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B05.tiff&#39;</span><span class="p">}</span>
<span class="n">B06</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;band&#39;</span><span class="p">:</span> <span class="s1">&#39;B06&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B06.tiff&#39;</span><span class="p">}</span>
<span class="n">B07</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;band&#39;</span><span class="p">:</span> <span class="s1">&#39;B07&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B07.tiff&#39;</span><span class="p">}</span>
<span class="n">B08</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;band&#39;</span><span class="p">:</span> <span class="s1">&#39;B08&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B08.tiff&#39;</span><span class="p">}</span>
<span class="n">B09</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;band&#39;</span><span class="p">:</span> <span class="s1">&#39;B09&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B09.tiff&#39;</span><span class="p">}</span>
<span class="n">B11</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;band&#39;</span><span class="p">:</span> <span class="s1">&#39;B11&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B11.tiff&#39;</span><span class="p">}</span>
<span class="n">B12</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;band&#39;</span><span class="p">:</span> <span class="s1">&#39;B12&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B12.tiff&#39;</span><span class="p">}</span>
<span class="n">B8A</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;band&#39;</span><span class="p">:</span> <span class="s1">&#39;B8A&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;https://github.com/bamacgabhann/GY4006/raw/main/gy4006/sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_L2A_B8A.tiff&#39;</span><span class="p">}</span>

<span class="k">with</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../sample_data/2021-04-25_11-46-59_Sentinel-2_L2A.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">meta</span><span class="p">)</span> <span class="k">as</span> <span class="n">dst</span><span class="p">:</span>
    <span class="n">bands</span> <span class="o">=</span> <span class="p">[</span><span class="n">B01</span><span class="p">,</span> <span class="n">B02</span><span class="p">,</span> <span class="n">B03</span><span class="p">,</span> <span class="n">B04</span><span class="p">,</span> <span class="n">B05</span><span class="p">,</span> <span class="n">B06</span><span class="p">,</span> <span class="n">B07</span><span class="p">,</span> <span class="n">B08</span><span class="p">,</span> <span class="n">B09</span><span class="p">,</span> <span class="n">B11</span><span class="p">,</span> <span class="n">B12</span><span class="p">,</span> <span class="n">B8A</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="n">bands</span><span class="p">:</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">band</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">])</span>
        <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">band</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">])</span>
        <span class="n">dst</span><span class="o">.</span><span class="n">set_band_description</span><span class="p">(</span><span class="n">band</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">],</span> <span class="n">band</span><span class="p">[</span><span class="s1">&#39;band&#39;</span><span class="p">])</span>
        <span class="n">b</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>I set Band 8A to be indexed as band 13 in this combined raster, because otherwise it would end up as band 9, with Band 09 as band 10 and so on which would get confusing very quickly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">killarney</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../sample_data/2021-04-25_11-46-59_Sentinel-2_L2A.tif&#39;</span><span class="p">)</span>
<span class="n">killarney</span><span class="o">.</span><span class="n">meta</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;driver&#39;: &#39;GTiff&#39;,
 &#39;dtype&#39;: &#39;float32&#39;,
 &#39;nodata&#39;: None,
 &#39;width&#39;: 1549,
 &#39;height&#39;: 1148,
 &#39;count&#39;: 13,
 &#39;crs&#39;: CRS.from_wkt(&#39;PROJCS[&quot;WGS 84 / UTM zone 29N&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Transverse_Mercator&quot;],PARAMETER[&quot;latitude_of_origin&quot;,0],PARAMETER[&quot;central_meridian&quot;,-9],PARAMETER[&quot;scale_factor&quot;,0.9996],PARAMETER[&quot;false_easting&quot;,500000],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH],AUTHORITY[&quot;EPSG&quot;,&quot;32629&quot;]]&#39;),
 &#39;transform&#39;: Affine(10.003089244673982, 0.0, 452133.272164,
        0.0, -10.002688485192044, 5769540.027478)}
</pre></div>
</div>
</div>
</div>
<p>Now, we can do some interesting things with the data a bit more easily.</p>
</section>
<section id="data-cleaning">
<h2>2. Data Cleaning<a class="headerlink" href="#data-cleaning" title="Link to this heading">#</a></h2>
<p>Unfortunately there’s one more preliminary step we have to do, and that’s a little bit of data cleaning.</p>
<p>All of the values contained in our rasters should be floating point numbers between 0 and 1. However, as a consequence of the preliminary data processing to L2A, some of the values have been increased above 1.</p>
<p>We can see this if we as <code class="docutils literal notranslate"><span class="pre">rasterio</span></code> to show us all values above 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">()[</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1.0408, 1.0912, 1.0632, 1.0351, 1.0795, 1.0115, 1.0164, 1.0837,
       1.0431, 1.0433, 1.0135, 1.041 , 1.0789, 1.0129, 1.0082, 1.0734,
       1.0346, 1.031 , 1.0018, 1.0414, 1.101 , 1.048 , 1.0529, 1.0188,
       1.0005, 1.0264, 1.1168, 1.1912, 1.0184, 1.0128, 1.0616, 1.1376,
       1.276 , 1.3104, 1.2736, 1.028 , 1.1872, 1.1784, 1.1296, 1.0576,
       1.04  , 1.0352, 1.012 , 1.0128, 1.0056, 1.1176, 1.0686, 1.1327,
       1.1046, 1.0368, 1.0534, 1.1332, 1.145 , 1.2644, 1.4308, 1.4245,
       1.1414, 1.1372, 1.4183, 1.5269, 1.4907, 1.2835, 1.0792, 1.1326,
       1.4379, 1.5442, 1.5247, 1.3933, 1.1456, 1.1638, 1.0407, 1.3253,
       1.4826, 1.525 , 1.4702, 1.2932, 1.1846, 1.119 , 1.2221, 1.4279,
       1.528 , 1.5212, 1.4091, 1.1683, 1.1551, 1.1641, 1.0242, 1.1261,
       1.3788, 1.5331, 1.5463, 1.4932, 1.4286, 1.2591, 1.0758, 1.176 ,
       1.1132, 1.0214, 1.3315, 1.5411, 1.5581, 1.5277, 1.555 , 1.4588,
       1.0907, 1.1598, 1.1642, 1.2854, 1.5514, 1.5562, 1.5135, 1.5517,
       1.4949, 1.2358, 1.1145, 1.176 , 1.2017, 1.5131, 1.5403, 1.5121,
       1.5503, 1.5132, 1.3388, 1.0713, 1.0394, 1.0815, 1.4276, 1.5104,
       1.5225, 1.549 , 1.5123, 1.3998, 1.1664, 1.3374, 1.4774, 1.5329,
       1.5505, 1.5137, 1.4506, 1.2549, 1.2411, 1.4402, 1.5428, 1.5542,
       1.5169, 1.4904, 1.3354, 1.0911, 1.3475, 1.5118, 1.5531, 1.5365,
       1.5261, 1.3815, 1.2005, 1.4396, 1.5446, 1.5684, 1.5537, 1.3909,
       1.0201, 1.2626, 1.347 , 1.3505, 1.3144, 1.1616, 1.0077, 1.2594,
       1.2452, 1.1032, 1.2182, 1.5389, 1.6002, 1.4924, 1.1722, 1.0303,
       1.2635, 1.3106, 1.2356, 1.0065, 1.0061, 1.0484, 1.0514, 1.0154,
       1.0372, 1.2445, 1.1604, 1.1547, 1.4934, 1.4146, 1.1507, 1.1799,
       1.5189, 1.4784, 1.2408, 1.0618, 1.3714, 1.3986, 1.2356, 1.1105,
       1.302 , 1.3238, 1.0391, 1.0543, 1.1786, 1.1378, 1.1085, 1.406 ,
       1.5679, 1.5632, 1.3211, 1.1271, 1.1984, 1.2242, 1.5111, 1.5667,
       1.5275, 1.4772, 1.267 , 1.237 , 1.4109, 1.181 , 1.2313, 1.5382,
       1.557 , 1.5128, 1.558 , 1.4277, 1.2685, 1.5257, 1.3546, 1.0458,
       1.1312, 1.4873, 1.5359, 1.5153, 1.5642, 1.4736, 1.0787, 1.2246,
       1.5463, 1.4665, 1.2037, 1.025 , 1.4223, 1.5091, 1.5173, 1.5559,
       1.5019, 1.2828, 1.0126, 1.1292, 1.4936, 1.5236, 1.3404, 1.3418,
       1.4761, 1.5189, 1.5327, 1.5116, 1.4959, 1.3695, 1.0053, 1.3684,
       1.5261, 1.4551, 1.0113, 1.2187, 1.4208, 1.5221, 1.527 , 1.5157,
       1.5842, 1.5332, 1.2088, 1.2397, 1.4875, 1.5057, 1.107 , 1.054 ,
       1.3438, 1.5271, 1.538 , 1.514 , 1.5516, 1.5102, 1.3114, 1.0423,
       1.106 , 1.4064, 1.4914, 1.1538, 1.2698, 1.5374, 1.5504, 1.5128,
       1.5294, 1.5041, 1.4248, 1.2238, 1.1918, 1.2982, 1.0308, 1.198 ,
       1.552 , 1.564 , 1.5121, 1.5158, 1.5122, 1.5464, 1.4108, 1.1035,
       1.505 , 1.5469, 1.5135, 1.5126, 1.5157, 1.5972, 1.4973, 1.3977,
       1.4997, 1.5168, 1.5196, 1.5147, 1.5793, 1.4865, 1.0296, 1.2489,
       1.4401, 1.5352, 1.5431, 1.5291, 1.5852, 1.4981, 1.0919, 1.059 ,
       1.3664, 1.5657, 1.5801, 1.5556, 1.6098, 1.5261, 1.141 , 1.194 ,
       1.4323, 1.4457, 1.3982, 1.3871, 1.277 , 1.1401, 1.1453, 1.0633,
       1.2586, 1.3798, 1.4125, 1.4366, 1.4134, 1.3601, 1.1953, 1.1044,
       1.542 , 1.6079, 1.5774, 1.583 , 1.5709, 1.5679, 1.4712, 1.1583,
       1.1893, 1.5461, 1.5715, 1.5207, 1.5197, 1.5204, 1.5295, 1.5204,
       1.487 , 1.392 , 1.1937, 1.1448, 1.4452, 1.5347, 1.5582, 1.5682,
       1.5511, 1.4909, 1.4567, 1.5386, 1.5806, 1.4756, 1.2962, 1.0432,
       1.4281, 1.5277, 1.4211, 1.0808, 1.2213, 1.4337, 1.5881, 1.6211,
       1.5701, 1.3937, 1.2666, 1.3576, 1.4727, 1.5077, 1.5049, 1.4764,
       1.3892, 1.2216, 1.1162, 1.5941, 1.6302, 1.4476, 1.025 , 1.008 ,
       1.155 , 1.2   , 1.1687, 1.0108, 1.0791, 1.2428, 1.3996, 1.5307,
       1.5683, 1.439 , 1.2145, 1.2782, 1.5254, 1.4056, 1.1312, 1.0499,
       1.2921, 1.428 , 1.3584, 1.2234, 1.117 , 1.1268, 1.4359, 1.5206,
       1.19  , 1.0507, 1.0483, 1.0165, 1.0619, 1.0293, 1.3149, 1.5616,
       1.5187, 1.1082, 1.3743, 1.5104, 1.3619, 1.2194, 1.4184, 1.338 ,
       1.1126, 1.3418, 1.333 , 1.0979, 1.0028, 1.3162, 1.5055, 1.4951,
       1.3419, 1.0303, 1.1722, 1.3958, 1.2195, 1.264 , 1.5325, 1.5632,
       1.4687, 1.2995, 1.0346, 1.3848, 1.5494, 1.4873, 1.133 , 1.0818,
       1.4747, 1.5378, 1.5053, 1.535 , 1.4148, 1.1241, 1.5891, 1.6544,
       1.4765, 1.0038, 1.2804, 1.4433, 1.5161, 1.5891, 1.5225, 1.1858,
       1.2523, 1.5298, 1.5603, 1.3719, 1.2822, 1.4868, 1.5071, 1.4403,
       1.3677, 1.1599, 1.1601, 1.4308, 1.5107, 1.3582, 1.0661, 1.0879,
       1.3938, 1.4529, 1.4302, 1.4538, 1.3181, 1.4715, 1.6171, 1.4951,
       1.0845, 1.2269, 1.3802, 1.4322, 1.4492, 1.3113, 1.578 , 1.6811,
       1.5151, 1.0525, 1.1117, 1.2827, 1.3533, 1.258 , 1.1118, 1.536 ,
       1.6412, 1.5315, 1.155 , 1.021 , 1.1678, 1.1361, 1.0036, 1.327 ,
       1.527 , 1.5018, 1.3281, 1.0238, 1.4383, 1.5591, 1.5052, 1.2715,
       1.3106, 1.5785, 1.5195, 1.3028, 1.3059, 1.5171, 1.5141, 1.3052,
       1.455 , 1.5952, 1.5091, 1.2716, 1.3877, 1.5539, 1.5161, 1.3347,
       1.0277, 1.1168, 1.3945, 1.4818, 1.2921, 1.1275, 1.3854, 1.1615,
       1.022 , 1.1631, 1.4005, 1.4133, 1.2581, 1.195 , 1.463 , 1.5316,
       1.43  , 1.0958, 1.2466, 1.3791, 1.3813, 1.1972, 1.0528, 1.2492,
       1.3431, 1.2781, 1.1426, 1.0938, 1.2747, 1.3219, 1.2943, 1.2391,
       1.0762, 1.0802, 1.2798, 1.3911, 1.393 , 1.2527, 1.1811, 1.437 ,
       1.4697, 1.3449, 1.0373, 1.1662, 1.4265, 1.4992, 1.4068, 1.0966,
       1.195 , 1.3757, 1.4858, 1.4304, 1.0807, 1.1455, 1.3822, 1.4727,
       1.3976, 1.0703, 1.0456, 1.4139, 1.4532, 1.3288, 1.0671, 1.3577,
       1.4175, 1.331 , 1.1673, 1.2465, 1.3744, 1.3791, 1.3194, 1.1025,
       1.1681, 1.3708, 1.4296, 1.3076, 1.0325, 1.1197, 1.3908, 1.4716,
       1.179 , 1.1682, 1.4014, 1.4248, 1.0268, 1.2759, 1.3834, 1.2877,
       1.1724, 1.3004, 1.184 , 1.2503, 1.3534, 1.2509, 1.339 , 1.2896,
       1.0475, 1.0119, 1.2412, 1.0499, 1.0147, 1.0462, 1.0637, 1.2344,
       1.3372, 1.0116, 1.2776, 1.1098, 1.0744, 1.0985, 1.1955, 1.013 ,
       1.3044, 1.0117, 1.2282, 1.078 , 1.1915, 1.021 , 1.2559, 1.152 ,
       1.1954, 1.1691, 1.2049, 1.2818, 1.1509, 1.1977, 1.3044, 1.191 ,
       1.0235, 1.2333, 1.206 , 1.42  , 1.447 , 1.2359, 1.4868, 1.5932,
       1.4733, 1.1215, 1.0846, 1.535 , 1.6592, 1.5784, 1.2804, 1.1695,
       1.5312, 1.6305, 1.5565, 1.3109, 1.0669, 1.3538, 1.3968, 1.2959,
       1.0881, 1.0717, 1.0471, 1.0868, 1.1528, 1.2009, 1.3018, 1.07  ,
       1.0315, 1.0585, 1.0392, 1.1036, 1.1389, 1.0782, 1.0533, 1.1194,
       1.0863, 1.0073, 1.0714, 1.0466], dtype=float32)
</pre></div>
</div>
</div>
</div>
<p>That looks like a lot, but for context:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">()[</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(740,)
</pre></div>
</div>
</div>
</div>
<p>That means there’s 740 values above 1. The whole dataset, though:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(13, 1148, 1549)
</pre></div>
</div>
</div>
</div>
<p>It’s actually 12 bands, since band 10 is empty, but that’s still 12 x 1148 x 1549 pixels: a total of 21,339,024.</p>
<p>740 errors in over 21 million is a pretty good ratio, really.</p>
<p>Anyway, we can easily fix this issue by just setting all these values to 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">k</span><span class="p">[</span><span class="n">k</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mf">1.0</span>
<span class="n">kmeta</span><span class="o">=</span><span class="n">killarney</span><span class="o">.</span><span class="n">meta</span>
<span class="k">with</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../sample_data/2021-04-25_11-46-59_Sentinel-2_L2A.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kmeta</span><span class="p">)</span> <span class="k">as</span> <span class="n">dst</span><span class="p">:</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And just to check it worked:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">killarney</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../sample_data/2021-04-25_11-46-59_Sentinel-2_L2A.tif&#39;</span><span class="p">)</span>
<span class="n">killarney</span><span class="o">.</span><span class="n">meta</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;driver&#39;: &#39;GTiff&#39;,
 &#39;dtype&#39;: &#39;float32&#39;,
 &#39;nodata&#39;: None,
 &#39;width&#39;: 1549,
 &#39;height&#39;: 1148,
 &#39;count&#39;: 13,
 &#39;crs&#39;: CRS.from_wkt(&#39;PROJCS[&quot;WGS 84 / UTM zone 29N&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Transverse_Mercator&quot;],PARAMETER[&quot;latitude_of_origin&quot;,0],PARAMETER[&quot;central_meridian&quot;,-9],PARAMETER[&quot;scale_factor&quot;,0.9996],PARAMETER[&quot;false_easting&quot;,500000],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH],AUTHORITY[&quot;EPSG&quot;,&quot;32629&quot;]]&#39;),
 &#39;transform&#39;: Affine(10.003089244673982, 0.0, 452133.272164,
        0.0, -10.002688485192044, 5769540.027478)}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">()[</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([], dtype=float32)
</pre></div>
</div>
</div>
</div>
<p>Empty array means it worked!</p>
<p>It is important to do things like this, because if you want to do a calculations involving subtraction and division, you could end up with some unfortunate errors.</p>
<p>Anyway, let’s get on with the fun parts.</p>
</section>
<section id="false-colour-visualisations">
<h2>3. False Colour Visualisations<a class="headerlink" href="#false-colour-visualisations" title="Link to this heading">#</a></h2>
<p>The problem with trying to look at 12 or 13 different colours, including a number of infrared colours, is that we can only see three different colours. Every colour is a combination of red, green, and blue.</p>
<p>But just because an image has been captured in a colour we’re unable to see, doesn’t mean we can’t <em>show</em> it in a colour we can see. That’s essentially what I did above, showing the infrared colours in grey. But we can show them in any colour we want to.</p>
<p>For example, here’s Band 8A shown in green.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">show</span><span class="p">((</span><span class="n">killarney</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greens&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B8A (Narrow Near Infrared (NIR), 20m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/17a9a81d858982fd1f368cd8d2f81fccc0b281703708103943f9be2dc3f731a4.png" src="../../_images/17a9a81d858982fd1f368cd8d2f81fccc0b281703708103943f9be2dc3f731a4.png" />
</div>
</div>
<p>And here’s the blue light Band 02 shown in red:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">show</span><span class="p">((</span><span class="n">killarney</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B02 (Blue visible light, 10m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d21925a6bc1662547ca4ddc5520f36046de0cef696c1ab5a0c58ddd989d3f131.png" src="../../_images/d21925a6bc1662547ca4ddc5520f36046de0cef696c1ab5a0c58ddd989d3f131.png" />
</div>
</div>
<p>In these cases, I’m specifying which single colour to use - but we don’t have to stick with just one colour at a time. If Rasterio is passed 3 bands, it treats them as RGB - and of course, there’s no law saying we can only pass red, green, and blue as RGB.</p>
<p>For example, here’s a commonly used false colour combination based on bands 8, 4, and 3. This shows Band 08 (NIR) as red, Band 04 (red light) as green, and band 03 (green light) as blue.</p>
<p>(Rasterio expects the bands to be presented in the order red, green, blue - hence 8, 4, 3 in that order.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">show</span><span class="p">((</span><span class="n">killarney</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;False colour visualisation (B08, B04, B03)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e7fe8a223ddf183a87a8139c862bfd8bd737750d1a0fa0b9f26382fa270c8d7c.png" src="../../_images/e7fe8a223ddf183a87a8139c862bfd8bd737750d1a0fa0b9f26382fa270c8d7c.png" />
</div>
</div>
<p>And here’s a commonly used visualisation referred to a SWIR (Short Wave Infrared), based on Band 12 (SWIR), Band 8A (NIR), and Band 04 (red light):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">show</span><span class="p">((</span><span class="n">killarney</span><span class="p">,</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;SWIR visualisation (B12, B8A, B04)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5c421510ace5ef0e83f734a7fc6442d1348fa767fd3f1bc6563547ea7793a31f.png" src="../../_images/5c421510ace5ef0e83f734a7fc6442d1348fa767fd3f1bc6563547ea7793a31f.png" />
</div>
</div>
<p>This SWIR visualisation is extremely useful for distinguishing clouds, snow, and ice in areas where those are present (which all look white in RGB images, but show quite differently in SWIR). It’s also useful for disinguishing different kinds of vegetation, and different kinds of rocks - as well as something in the National Park area which I’m quite sure you’ve noticed there, and are wondering about. Hold that thought.</p>
<p>Here’s one for you too play with a little more easily.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">show</span><span class="p">((</span><span class="n">killarney</span><span class="p">,</span> <span class="p">[</span>

<span class="c1"># Change this number to the band you want to show in Red    </span>
    <span class="mi">9</span>

<span class="p">,</span><span class="c1"># Change this number to the band you want to show in Green    </span>
    <span class="mi">6</span>

<span class="p">,</span><span class="c1"># Change this number to the band you want to show in Blue    </span>
    <span class="mi">1</span>
    
<span class="p">]),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Custom visualisation&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/65d3476301fcfb709d21156096a531db55d19bffcc48a1b35e952cfdb259ba96.png" src="../../_images/65d3476301fcfb709d21156096a531db55d19bffcc48a1b35e952cfdb259ba96.png" />
</div>
</div>
<p>It would be impossible for me to list all the combinations and what they’re useful for, in exactly the same way that I wouldn’t be able to list how to identify objects by their colour. It’s too varied, there’s just too many things. There’s many, many uses, including mapping water, urban areas, type and health of vegetation, geology, land use, and much more. This is another case of, if you have an idea in mind, look up how to do it.</p>
</section>
<section id="indices">
<h2>4. Indices<a class="headerlink" href="#indices" title="Link to this heading">#</a></h2>
<p>We can go further. We’re not limited to the bands as they are saved in the raster file - we can do calculations with them.</p>
<p>Again, this is a case where there are hundreds, thousands of different calculations possible, so it’s not about learning the possibilities. Once again, it’s a case of, when you have something you want to do, you figure out how to do it. That said, you need to have some understanding of what’s possible in order to have an idea of where to start, so I’m going to show you two examples in order to explain the concept.</p>
<p><strong>NDVI</strong>
Possibly the best known and most-used index is the <em>Normalised Difference Vegetation Index</em>, or NDVI. This is based on just two bands: Band 08 (NIR) and Band 04 (red light).</p>
<p>Instead of plotting these two bands in different colours, the index is comparing the values of the two bands. This is the <em>Difference</em> part of the index formula:</p>
<p><code class="docutils literal notranslate"><span class="pre">B08</span> <span class="pre">-</span> <span class="pre">B04</span></code></p>
<p>We can plot just this part:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">show</span><span class="p">((</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">-</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B08-B04&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d676aff1850202a10289b66016f7406941cf4b2687a434116f4373d9dfdedb86.png" src="../../_images/d676aff1850202a10289b66016f7406941cf4b2687a434116f4373d9dfdedb86.png" />
</div>
</div>
<p>There is a problem with doing this though. Say we have two pixels.</p>
<p>In the first, <code class="docutils literal notranslate"><span class="pre">B08</span></code> is 0.8, and <code class="docutils literal notranslate"><span class="pre">B04</span></code> is 0.7.</p>
<p>In the second, <code class="docutils literal notranslate"><span class="pre">B08</span></code> is 0.2, and <code class="docutils literal notranslate"><span class="pre">B04</span></code> is 0.1.</p>
<p>In both cases, <code class="docutils literal notranslate"><span class="pre">B08</span> <span class="pre">-</span> <span class="pre">B04</span></code> gives 0.1 - but that’s now hiding the very different original values in <code class="docutils literal notranslate"><span class="pre">B08</span></code> and <code class="docutils literal notranslate"><span class="pre">B04</span></code> in the two pixels.</p>
<p>To avoid this, what we do is to <em>normalise</em> the numbers based on the total of their original values, i.e. <code class="docutils literal notranslate"><span class="pre">B08</span> <span class="pre">+</span> <span class="pre">B04</span></code>. Doing this means the 0.1 from our first pixel will be divided by 0.8+0.7 which totals to 1.5, giving a result of 0.667; while the 0.1 from our second pixel will be divided by 0.2+0.1 = 0.3, giving a result of 0.333.</p>
<p>So, the total formula is <code class="docutils literal notranslate"><span class="pre">(B08</span> <span class="pre">-</span> <span class="pre">B04)</span> <span class="pre">/</span> <span class="pre">(B08</span> <span class="pre">+</span> <span class="pre">B04)</span></code>.</p>
<p>This also gives us a good, fixed scale. The maximum that <code class="docutils literal notranslate"><span class="pre">B08</span> <span class="pre">-</span> <span class="pre">B04</span></code> can be is -1, in the case where <code class="docutils literal notranslate"><span class="pre">B08</span></code> is 0 and <code class="docutils literal notranslate"><span class="pre">B04</span></code> is 1 - since both vary between 0 and 1. Similarly, the minumum is the case where <code class="docutils literal notranslate"><span class="pre">B08</span></code> is 1 and <code class="docutils literal notranslate"><span class="pre">B04</span></code> is 0, meaning <code class="docutils literal notranslate"><span class="pre">B08</span> <span class="pre">-</span> <span class="pre">B04</span> <span class="pre">=</span> <span class="pre">1</span></code>. In both cases, <code class="docutils literal notranslate"><span class="pre">B08</span> <span class="pre">+</span> <span class="pre">B04</span> <span class="pre">=</span> <span class="pre">1</span></code>. So, the NDVI can vary between -1 and +1.</p>
<p>Let’s look at the full formula result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ndvi</span> <span class="o">=</span> <span class="p">(</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">-</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ndvi_meta</span> <span class="o">=</span> <span class="n">killarney</span><span class="o">.</span><span class="n">meta</span>
<span class="n">ndvi_meta</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_NDVI.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">ndvi_meta</span><span class="p">)</span> <span class="k">as</span> <span class="n">dst</span><span class="p">:</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ndvi</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">set_band_description</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;NDVI&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_345/991251910.py:1: RuntimeWarning: invalid value encountered in divide
  ndvi = (killarney.read(8)-killarney.read(4))/(killarney.read(8)+killarney.read(4))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">killarney_NDVI</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_NDVI.tif&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">temp_scale_setup</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">killarney_NDVI</span><span class="o">.</span><span class="n">read</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlGn&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">temp_scale_setup</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NDVI&quot;</span><span class="p">)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">show</span><span class="p">((</span><span class="n">killarney_NDVI</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;NDVI: Normalised Difference Vegetation Index, (B08 - B04) / (B08 + B04)&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlGn&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2cb8b489664734034da31a98969ceb52dab40e1bd04228cfb00397a2f7563449.png" src="../../_images/2cb8b489664734034da31a98969ceb52dab40e1bd04228cfb00397a2f7563449.png" />
</div>
</div>
<p>As you might guess from the name, the NDVI is excellent at distinguishing vegetation. Values close to 1 indicate strong vegetation like forestry. Low positive numbers generally indicate grasslands and shrubs, while bare soil, rock, and water will usually have negative values.</p>
<p><strong>NDMI</strong></p>
<p>Similarly, we can calculate the <em>Normalised Difference Moisture Index</em>, using bands B8A and B11.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ndmi</span> <span class="o">=</span> <span class="p">(</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="o">-</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="o">+</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>

<span class="n">ndmi_meta</span> <span class="o">=</span> <span class="n">killarney</span><span class="o">.</span><span class="n">meta</span>
<span class="n">ndmi_meta</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_NDMI.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">ndvi_meta</span><span class="p">)</span> <span class="k">as</span> <span class="n">dst</span><span class="p">:</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ndvi</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">set_band_description</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;NDMI&#39;</span><span class="p">)</span>

<span class="n">killarney_NDMI</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_NDMI.tif&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">temp_scale_setup</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">killarney_NDMI</span><span class="o">.</span><span class="n">read</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">temp_scale_setup</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NDMI&quot;</span><span class="p">)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">show</span><span class="p">((</span><span class="n">killarney_NDMI</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;NDMI: Normalised Difference Moisture Index, (B8A - B11) / (B8A + B11)&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_345/4234981925.py:1: RuntimeWarning: invalid value encountered in divide
  ndmi = (killarney.read(13)-killarney.read(11))/(killarney.read(13)+killarney.read(11))
</pre></div>
</div>
<img alt="../../_images/02ff20acd93bcdba9012eb2fc8170452a58ef8450ff39f990543db546975fa0c.png" src="../../_images/02ff20acd93bcdba9012eb2fc8170452a58ef8450ff39f990543db546975fa0c.png" />
</div>
</div>
<p>You might be wondering why the lake isn’t showing up solid red, and that’s because it’s a <em>moisture</em> index, not a <em>water</em> index - it’s very good at highlighting moisture in vegetation. So, strong blue colours here will represent vegetation with a lot of water, while light blues to greens will represent drier vegetation suffering from water stress. Green to red colours generally show non-vegetated areas.</p>
<p>There’s many, many more where these came from - I just wanted to use these two as examples. There’s a great list curated on GitHub which you can find here: <a class="github reference external" href="https://github.com/awesome-spectral-indices/awesome-spectral-indices">awesome-spectral-indices/awesome-spectral-indices</a></p>
</section>
<section id="segmentation">
<h2>5. Segmentation<a class="headerlink" href="#segmentation" title="Link to this heading">#</a></h2>
<p>We can go beyond indices, and do more complex calculations to identify particular features in our imagery.</p>
<p>Again, I’ll demonstrate with an example. We’ll start by doing a band calculation similar to the NDVI or NDMI indices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">segmented</span> <span class="o">=</span> <span class="p">(</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">-</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">+</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">+</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we apply a <em>threshold</em> value - setting any pixels below that value as np.nan, <em>Not a Number</em>. This leaves only the data we’re interested in, i.e. the areas where the pixel value is higher than our threshold.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">segmented</span><span class="p">[</span><span class="n">segmented</span><span class="o">&lt;</span><span class="mf">0.04</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
</div>
<p>We can plot this on a map - and let’s add an RGB basemap, so that we have something to see where our <code class="docutils literal notranslate"><span class="pre">segmented</span></code> raster values are <code class="docutils literal notranslate"><span class="pre">np.nan</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">killarney</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">segmented</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">killarney</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Killarney Wildfire 25 April 2021&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Reds_r&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [0.0..2.5].
</pre></div>
</div>
<img alt="../../_images/c2101337873a0c42466af580d5272727231d0379c3aa6b781d6fc1dfe7855097.png" src="../../_images/c2101337873a0c42466af580d5272727231d0379c3aa6b781d6fc1dfe7855097.png" />
</div>
</div>
<p>You can see the red areas on the map, I hope - and you can also see the title. This process has isolated pixels which are interpreted as showing active wildfire burning.</p>
<p>I can confirm their accuracy: I was there at the time. I’m in that photo, somewhere. Just a bit too small to make out!</p>
<p>We can save this as a file:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fire_meta</span> <span class="o">=</span> <span class="n">killarney</span><span class="o">.</span><span class="n">meta</span>
<span class="n">fire_meta</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_fire.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">fire_meta</span><span class="p">)</span> <span class="k">as</span> <span class="n">dst</span><span class="p">:</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">segmented</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">set_band_description</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Wildfire 2021-04-25&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, we didn’t actually <em>have</em> to do the thresholding there. We could have just shown the result of the calculation, without the threshold:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calc</span> <span class="o">=</span> <span class="p">(</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">-</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">+</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">+</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">show</span><span class="p">(</span><span class="n">calc</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">killarney</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Killarney Wildfire 25 April 2021&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Reds_r&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d64521e43f6017024f237f10690187c2b90cbe2a03ef77daab212cb32551152a.png" src="../../_images/d64521e43f6017024f237f10690187c2b90cbe2a03ef77daab212cb32551152a.png" />
</div>
</div>
<p>We can still see the active fire pixels are much brighter there, but the rest of the map isn’t telling us anything useful. Much better to isolate the useful pixels, and show only them.</p>
<p>We can also create an array of <em>Boolean</em> values, listing <code class="docutils literal notranslate"><span class="pre">False</span></code> for non-fire and <code class="docutils literal notranslate"><span class="pre">True</span></code> for fire pixels. This would commonly be referred to as a <em>mask</em> - such Boolean data is used to mask out (i.e. hide) pixels with a Boolean value of False in the mask data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fire_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">-</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">+</span><span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">+</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">fire_shape</span><span class="p">[</span><span class="n">fire_shape</span><span class="o">&lt;</span><span class="mf">0.04</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="n">fire_shape</span><span class="p">[</span><span class="n">fire_shape</span><span class="o">&gt;</span><span class="mf">0.04</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
<span class="n">fire_mask</span> <span class="o">=</span> <span class="n">fire_shape</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
<span class="n">fire_mask</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       ...,
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False]],
      shape=(1148, 1549))
</pre></div>
</div>
</div>
</div>
<p>Something along these lines is often a key step in building maching learning models, where the computer would be essentially learning where particular values are <code class="docutils literal notranslate"><span class="pre">True</span></code>, and using that to predict where values would be <code class="docutils literal notranslate"><span class="pre">True</span></code> elsewhere.</p>
<p>I’m not going any further into machine learning though. More usefully for our purposes right now, we can create vector shapes for the fire areas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fire_shape</span><span class="p">[</span><span class="n">fire_shape</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="k">with</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_fire_shape.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">fire_meta</span><span class="p">)</span> <span class="k">as</span> <span class="n">dst</span><span class="p">:</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fire_shape</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">set_band_description</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Fire&#39;</span><span class="p">)</span>

<span class="n">fireshapes_raster</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_fire_shape.tif&#39;</span><span class="p">)</span>
<span class="n">fireshapes_df</span> <span class="o">=</span> <span class="n">dataset_features</span><span class="p">(</span><span class="n">fireshapes_raster</span><span class="p">,</span> <span class="n">bidx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">band</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_mask</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_nodata</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">geographic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fire_vector</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="o">.</span><span class="n">from_features</span><span class="p">(</span><span class="n">fireshapes_df</span><span class="p">,</span><span class="n">crs</span><span class="o">=</span><span class="mi">32629</span><span class="p">)</span>
<span class="n">fire_vector</span> <span class="o">=</span> <span class="n">fire_vector</span><span class="p">[</span><span class="n">fire_vector</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]</span><span class="o">==</span><span class="mf">1.0</span><span class="p">]</span>
<span class="n">fire_vector</span> <span class="o">=</span> <span class="n">fire_vector</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="s1">&#39;filename&#39;</span><span class="p">])</span>
<span class="n">fire_vector</span><span class="p">[</span><span class="s1">&#39;Fire&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span>
<span class="n">fire_vector</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s1">&#39;../sample_data/Killarney/2021-04-25_11-46-59_Sentinel-2_fire_vector.gpkg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">killarney</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">killarney</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">fire_vector</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Red&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [0.0..2.5].
</pre></div>
</div>
<img alt="../../_images/fecbc7b3b77a8f70f3d4e39dba89c93f8b8d7ad584506b35cfd15385e1a12037.png" src="../../_images/fecbc7b3b77a8f70f3d4e39dba89c93f8b8d7ad584506b35cfd15385e1a12037.png" />
</div>
</div>
<p>Once you have vector shapes, more geoprocessing options become open:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="n">fire_vector</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">area</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>185407.0767243383
</pre></div>
</div>
</div>
</div>
<p>That’s how many square metres were burning, when this imagery was collected.</p>
<p>Of course, we can also combine some of the data we’ve just analysed with some of the data from the Single-band Raster Data Notebook:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dem</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/bamacgabhann/GY4006/main/gy4006/sample_data/Killarney/DEM_COPERNICUS_30.tiff&#39;</span><span class="p">)</span>
<span class="n">shade</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">hillshade</span><span class="p">(</span><span class="n">dem</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">azimuth</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">altitude</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">bounds</span>  <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">:[</span><span class="n">box</span><span class="p">(</span><span class="o">*</span><span class="n">dem</span><span class="o">.</span><span class="n">bounds</span><span class="p">)]})</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="mi">32629</span><span class="p">)</span>
<span class="n">killarney_roads</span> <span class="o">=</span> <span class="n">ox</span><span class="o">.</span><span class="n">features_from_polygon</span><span class="p">(</span><span class="n">bounds</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="mi">4326</span><span class="p">)[</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">tags</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;highway&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="mi">32629</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">temp_scale_setup</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">killarney_NDVI</span><span class="o">.</span><span class="n">read</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlGn&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">temp_scale_setup</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NDVI&quot;</span><span class="p">)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">452100</span><span class="p">,</span> <span class="mi">467700</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">5758000</span><span class="p">,</span> <span class="mi">5769500</span><span class="p">)</span>

<span class="n">show</span><span class="p">((</span><span class="n">killarney_NDVI</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Killarney 2021-04-25, NDVI with hillshade DEM, roads, and active wildfires&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlGn&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">shade</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">dem</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">killarney_roads</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s2">&quot;highway&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gist_yarg&quot;</span><span class="p">)</span>
<span class="n">fire_vector</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Red&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7a3f5291b4121fb8ba3735bad715669b3ff1a2d39997eb96583252903282f771.png" src="../../_images/7a3f5291b4121fb8ba3735bad715669b3ff1a2d39997eb96583252903282f771.png" />
</div>
</div>
<p>Now, how about that for a tasty map?</p>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>So, yes, through all the raster data so far we’ve actually been exploring data relevant to the Killarney wildfire of April 2021.</p>
<ul class="simple">
<li><p>We started with photographs (actually bands 04, 03, and 02 from the Sentinel 2 satellite);</p></li>
<li><p>We brought in a DEM of the area;</p></li>
<li><p>We looked at the land surface temperatures in the area for that month (maximum of 12°C, according to our data);</p></li>
<li><p>We looked at the NDVI to see vegetation in the area (not great in the fire area, but that’s mostly <em>after</em> the fire);</p></li>
<li><p>We looked at the NDMI for vegetation moisture (pretty dry in the fire area);</p></li>
<li><p>Finally, we extracted the shape of the active fires at the time the imagery was collected.</p></li>
</ul>
<p>If wildfires is what you’re interested in, there’s plenty more you can do there. We could also have tried to extract the shape of the burned area - and you can see that pretty clearly on the RGB imagery. We could look at vegetation and moisture <em>before</em> wildfires, and find other places with similar vegetation and moisture which could be at risk of wildfires. We could assess the vegetation before and after the wildfire to look at the changes.</p>
<p>But this is only one example of how remote sensing data can be used in environmental geospatial data analysis.</p>
<p>Remote sensing imagery can also be used to help assess biodiversity, to monitor agriculture, to look at flooding, to map landslides, to assess water quality, to measure snow and ice cover, and to map land use.</p>
<p>Even when I was doing my PhD, remote sensing data was <em>very</em> hard to work with, and not easy to get. Now? With the massive advance in computation power, as well as resources like Colab, analysis of the data has become possible for essentially anyone who wants to try. Even more importantly, we all have access to some absolutely incredible datasets. Sentinel 2A was launched in 2015, and <em>all</em> of its data is open access. Most data from the US civilian agencies is open access now as well, including LANDSAT and MODIS, and there’s data available from other countries as well.</p>
<p>And that’s just the multispectral satellites. In the EU’s Copernicus programme, there’s also Sentinel 3 monitoring the oceans, Sentinel 5P monitoring the atmosphere and air pollution, and Sentinel 6 to measure sea level change - and Sentinel 1, which uses RADAR for earth observation. That’s up next week for us.</p>
<p>The easiest way to access the data is through the <a href='https://apps.sentinel-hub.com/eo-browser/'>Copernicus Browser</a>. Copernicus is the EU’s Earth Observation programme - registration is required, but it’s free. US data is available from <a href='https://earthexplorer.usgs.gov/'>USGS Earth Explorer</a> or <a href='https://search.earthdata.nasa.gov/search'>NASA Earthdata</a>.</p>
<p>Between the availability of data, and the computing resources available to use it, the possibilities are virtually limitless. It’s just a case of, what do you want to do with it?</p>
<hr class="docutils" />
<p>GY4006 Notebooks in Colab:</p>
<ol class="arabic simple" start="2">
<li><p>Data Types <a href="https://colab.research.google.com/github/bamacgabhann/GY4006/blob/main/gy4006/notebooks/GY4006_2_Data_Types.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p></li>
<li><p>Vector Data <a href="https://colab.research.google.com/github/bamacgabhann/GY4006/blob/main/gy4006/notebooks/GY4006_3_Vector_Data.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p></li>
<li><p>Attribute Data <a href="https://colab.research.google.com/github/bamacgabhann/GY4006/blob/main/gy4006/notebooks/GY4006_4_Attribute_Data.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p></li>
<li><p>Coordinate Reference Systems <a href="https://colab.research.google.com/github/bamacgabhann/GY4006/blob/main/gy4006/notebooks/GY4006_5_Coordinate_Reference_Systems.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p></li>
<li><p>Geospatial Data Files <a href="https://colab.research.google.com/github/bamacgabhann/GY4006/blob/main/gy4006/notebooks/GY4006_6_Geospatial_Data_Files.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p></li>
<li><p>Vector Geoprocessing <a href="https://colab.research.google.com/github/bamacgabhann/GY4006/blob/main/gy4006/notebooks/GY4006_7_Vector_Geoprocessing.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p></li>
<li><p>Introduction to Raster Data <a href="https://colab.research.google.com/github/bamacgabhann/GY4006/blob/main/gy4006/notebooks/GY4006_8_Introduction_To_Raster_Data.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p></li>
<li><p>Single-band Raster Data <a href="https://colab.research.google.com/github/bamacgabhann/GY4006/blob/main/gy4006/notebooks/GY4006_9_Single-band_Raster_Data.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p></li>
<li><p>Multi-band Raster Data: Passive Remote Sensing <a href="https://colab.research.google.com/github/bamacgabhann/GY4006/blob/main/gy4006/notebooks/GY4006_10_Multi-band_Raster_Data-Passive_Remote_Sensing.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./gy4006/notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="GY4006_9_Single-band_Raster_Data.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Single-band Raster Data</p>
      </div>
    </a>
    <a class="right-next"
       href="../exercises/start.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Before you start</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multispectral-imaging-msi">1. Multispectral Imaging (MSI)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning">2. Data Cleaning</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#false-colour-visualisations">3. False Colour Visualisations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#indices">4. Indices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#segmentation">5. Segmentation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr. Breandán Anraoi MacGabhann
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>